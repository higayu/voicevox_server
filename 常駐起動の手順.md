ポート番号8888で常駐設定

# venv 内に Uvicorn を入れる
source /var/www/voicevox_server/venv/bin/activate
pip install "uvicorn[standard]"

------------------------------------

sudo tee /etc/systemd/system/voicevox.service >/dev/null <<'UNIT'
[Unit]
Description=voicevox_server on port 8888
Wants=network-online.target
After=network-online.target

[Service]
Type=simple
User=user
Group=user
WorkingDirectory=/var/www/voicevox_server

# venv とライブラリパス（voicevox_core downloader で取得した c_api / onnxruntime を通す）
Environment=VIRTUAL_ENV=/var/www/voicevox_server/venv
Environment=PATH=/var/www/voicevox_server/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
Environment=LD_LIBRARY_PATH=/var/www/voicevox_server/voicevox_core/c_api/lib:/var/www/voicevox_server/voicevox_core/onnxruntime/lib
Environment=PYTHONUNBUFFERED=1

# ☆ Uvicorn で 0.0.0.0:8888 に公開（app.py 内の "app" を参照）
ExecStart=/var/www/voicevox_server/venv/bin/uvicorn app:app --host 0.0.0.0 --port 8888 --proxy-headers

# 落ちたら自動再起動
Restart=always
RestartSec=3

# ログは journalctl で確認
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
UNIT


---------------------------------

sudo systemctl daemon-reload
sudo systemctl enable --now voicevox.service
sudo systemctl status voicevox.service --no-pager

-------------------------

journalctl -u voicevox.service -f

------------------
uvicorn main:app --reload
-------------------
# 変更反映
sudo systemctl restart voicevox.service

# 状態確認
sudo systemctl status voicevox.service --no-pager
journalctl -u voicevox.service -n 50 --no-pager

-------------------------------
curl -v --get 'http://192.168.1.229:8888/speak2' \
  --data-urlencode 'text=おはようございます' \
  -H 'Accept: audio/wav' \
  -o speak2.wav
----------------------------
